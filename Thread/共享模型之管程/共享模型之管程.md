## 一、共享带来的问题

```java
    public  static  int count=0;

    public static void main(String[] args) throws  Exception {

        Thread thread1 = new Thread(() -> {
            for (int i = 0; i < 5000; i++) {
                count--;
            }
        });
        Thread thread2 = new Thread(() -> {
            for (int i = 0; i < 5000; i++) {
                count++;
            }
        });
        thread1.start();
        thread2.start();
        thread1.join();
        thread2.join();

        System.out.println("count的值：" + count );
    }
```

```
执行上面的方法，我们会认为最后count的值是0
但是执行结果有正的有负的，不一定是0
这是为什么呢？ 
原因就是++ 和 --操作不是原子操作 
假设thread1拿到CPU的时间片，对count进行 -- 操作此时的count应该是-1 但是往内存中写入的之前 thread1失去了CPU的时间片， thread2拿到count的值是0，他进行自增后的值是1 这时就乱了

```

![](./png/Snipaste_2021-03-24_19-41-37.png)

